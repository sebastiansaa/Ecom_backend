Para mantener el AuthService limpio y auditable se recomienda dividir la lógica en capas y servicios auxiliares: usar helpers/utils para funciones puras como hash y generación de identificadores, crear subservicios como TokenService para firma y validación de JWT, UserService para validación y registro de usuarios y SessionService para manejo de refresh tokens, implementar repositorios con Prisma como UserRepository y RefreshTokenRepository para separar el acceso a datos, y finalmente mantener un checklist de capas donde AuthService actúe como orquestador, TokenService maneje los JWT, UserRepository gestione usuarios, RefreshTokenRepository gestione tokens de sesión y Utils concentre funciones auxiliares.
